## Elastic Compute Cloud (EC2) 실습
- 인스턴스 생성
    1. 인스턴스 메뉴에 접속
    2. 인스턴스 시작 버튼 클릭
    3. 인스턴스의 이름을 입력 후 AMI 선택
    4. 인스턴스 유형 선택
    5. 키 페어 선택
    6. 네트워크 설정에서 보안그룹 생성 또는 선택
    7. 스토리지 구성에서 용량 저장장치 종류 선택
    8. 인스턴스 시작 버튼 클릭
    9. 인스턴스 메뉴에서 인스턴스가 정상적으로 생성되었는지 확인, 일정시간 후에 상태검사가 완료됐는지 확인할 것.


- 인스턴스 종료
: EC2 인스턴스는 삭제방법이 따로 없다. 종료하면 이후에 자동으로 삭제된다.
    1. 인스턴스 메뉴에 접속
    2. 종료할 인스턴스 선택
    3. 인스턴스 상태 메뉴에서 인스턴스 종료선택
    4. 일정 시간이 지나면 종료된다.
    (! EC2인스턴스는 시작하게되면 자동으로 EBS가 할당된다. 인스턴스를 종료하면 EBS에서 볼륨이 제거된다. 인스턴스를 종료하더라도 만들어진 보안그룹은 삭제되지 않는다.)

## Terminal로 ssh 접속하기
IPv4 주소 복사
1. 터미널에 ssh -i 키파일경로 ubuntu@IPv4주소 입력
-> 키파일에 대한 권한 오류가 발생

2. ls -ld 키파일경로 명령어로 키파일의 권한 확인

3. chmod 700 키파일이 들어있는 폴더 경로 명령어로 폴더의 권한 변경

4. chmod 600 키파일경로 명령어로 키파일의 권한 변경

5. 다시 ssh -i 키파일경로 ubuntu@IPv4주소 입력하면 ubuntu로 접속이 된 모습을 볼 수 있다.

## Elastic IP 주소 사용해보기
- 할당받고 연결하기
    1. EC2 메뉴에서 탄력적 IP 탭 
    2. 탄력적 IP 할당하기 버튼 클릭 
    3. 탄력적 IP 주소 설정에서 네트워크 경계 그룹에 리전을 확인할 수 있음 -> 할당버튼클릭
    4. 탄력적 IP 주소 연결 버튼 
    5. 리소스 유형 인스턴스 선택 
    6. 만들어둔 인스턴스를 선택 후 연결버튼 
    7. 인스턴스 목록에서 연결된 탄력적 IP 주소 확인가능
    8. 터미널에서 ssh -i 키파일경로 ubuntu@할당받고 연결한 탄력적 IP 주소 입력

- 연결 해제하는법 
: 작업 -> 탄력적 IP주소 연결해제 -> 탄력적 IP주소 릴리스(할당받은 주소를 반환하는 것) 

## EBS(Elastic Block Store)
: EC2에 attach 해서 쓸 수 있는 블록 스토리지


- 특징
    1. 하나의 EBS를 여러개의 EC2에 연결할 수는 없다.
    2. 여러개의 EBS를 하나의 EC2에 연결할 수 있다.
    3. 단일 가용 영역내에서 여러 서버에 걸쳐서 복제
    4. 특정 시점에 대한 볼륨의 스냅샷을 만들 수 있음 (스냅샷은 S3에 저장되며, 복수개의 가용영역에 걸쳐 자동으로 복제됨)

- 용어 설명
    - 볼륨
    : 가장 기본적인 형태로 EC2에 바로 attach가능

    - 스냅샷
    : 볼륨의 특정 시점을 그대로 복사하여 저장한 파일, 백업용

    - AMI
    : OS가 설치된 형태의 이미지 파일, 이를 이용해 EC2인스턴스 생성가능

    - IOPS
    : 저장 장치의 성능 단위

## EBS(Elastic Block Store) 실습
- 볼륨 생성하고 연결하기
    1. Elastic Block Store 메뉴의 하단 볼륨 메뉴 클릭
    2. 볼륨 생성 버튼 클릭
    3. 볼륨 설정 부분의 크기입력, 가용영역 선택 후 볼륨 생성 버튼 클릭(연결하고자 하는 인스턴스와 동일한 가용영역을 선택해야함)
    4. 생성된 볼륨을 선택 후 작업메뉴-> 볼륨 연결 클릭
    5. 연결할 인스턴스 선택 후 볼륨 연결버튼 클릭
    6. 인스턴스 메뉴 -> 인스턴스 선택 -> 스토리지 탭으로 가면 연결된 볼륨 확인가능
- 스냅샷 생성하기
    1. 스냅샷을 생성하고자 하는 볼륨 선택
    2. 작업 메뉴에서 스냅샷 생성 버튼 클릭
    3. 설명 작성후 생성버튼 클릭
    4. 스냅샷 탭으로 가서 확인해보면 스냅샷이 생성되어있는 모습을 확인 가능.

- 스냅샷 삭제하기
    1. 스냅샷 메뉴에서 삭제할 스냅샷 선택
    2. 작업 - 스냅샷 삭제 클릭
    3. 삭제 버튼 클릭

- 볼륨 분리하고 삭제하기
    1. 삭제할 볼륨 선택
    2. 작업 - 볼륨 분리 클릭
    3. 분리 버튼 클릭
    4. 이후에 볼륨 삭제 가능.

## Load Balancing
: 부하(traffic)를 분산시키는 방법. Load Balancer를 통해 가능. Load Balancing 알고리즘에 따라 요청들을 분산시키고, 각 서버에서 처리함.

- 개념정리(빵을 나눠주는 방법)
선생님 1명, 유통기한 30분 남은 빵 1개가 있다.
학생 8 명에게 나눠주고 먹어야한다.
이를 골고루 나눠주는 방법은?

1. 우등생 4명에게만 나눠주기
: 형평성에 어긋남. 남은 4명의 학생은 허기짐, 불평제기

2. 8명에게 8등분해서 나눠주기
: 쟤들은 공부도 못하는데 왜주냐고 우등생 4명이 불만을 제기함.

3. 우등생에게 빵의 4분의 3, 열등생에게 4분의 1을 나눠줌
: 형평성에 어긋남.

4. 빵 잘먹는애 4분의 3, 못 먹는애 4분의 1을 나눠줌
: 억지로 먹는 애가 생김

5. 먹고싶은 사람에게만 빵을 등분해줌
: 형평성도 ok, 효율도 ok

이처럼 선생님이 정한 방법에 따라 나눠주고 각 학생들이 30분내에 먹어서 없앰

선생 : Load Balancer(ELB)
빵: 클라이언트들의 요청
학생 : 각각의 서버(EC2 인스턴스)

- 목적
    1. 성능 향상(Performance)
    2. 안정성 향상(Stablity)
    3. 서버 장애 예방(Back up Plan)
    4. 고가용성(HA - High Availablity)
    : 서버가 오랜기간 동안 정상적으로 작동이 가능한 성질 => 고장이 잘 나지 않음
    5. 

- 용어 설명
    1. Load Balancing 알고리즘
    : 트래픽을 각 서버에 분배하는 방법

    2. Health Check
    : 서버가 살아있는지 확인하는 것. 서버가 중단되었다면 트래픽을 분배하지 않는다.

    3. Connection Draining(등록 취소 지연)
    : 사용자의 요청을 처리중인 서버를 곧바로 삭제하지 못하도록 하는 기능
    if . 트래픽이 줄어서 늘렸던 인스턴스 중 몇개를 삭제하려고 할때, 삭제될 인스턴스에 연결중인 사용자가 있을 수 있기 때문에 지정한 시간만큼 기다린 이후에 인스턴스를 제거함.

    4. Latency
    : Load Balancer 와 서버 사이의 지연시간

## ELB(Elastic Load Balancing)
: ELB는 부하를 여러개의 EC2에 분산시켜주는 역할을 함. ELB는 리전별로 생성되는 특징을 가짐.

- ELB Load Balancer유형
    1. ALB(Application Load Balancer)
    : 개별 요청 수준에서 작동(L7 switch)
    HTTPS, HTTP

    2. NLB(Network Load Balancer)
    : 연결 수준에서 작동(L4 switch)

    TCP, UDP
    3. CLB(Classic Load Balancer)
    : 위의 두 유형을 합친 구형모델

서버에 스트레스 주는 법
sudo apt-get install stress
stress --cpu 4

빗나미 어드민 아이디, 비밀번호 확인 명령어
cat bitnami_credentials